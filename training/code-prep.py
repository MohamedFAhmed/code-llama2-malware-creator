import os
import shutil

# Define the source and destination directories
source_dir = 'malware-exhibit'  # Replace with the path to the target folder
destination_dir = 'malware-exhibit-flatened'  # Replace with the path to the new folder

# Create the destination directory if it doesn't exist
if not os.path.exists(destination_dir):
    os.makedirs(destination_dir)

# List of programming file extensions (common ones)
code_file_extensions = [
    '.c', '.cpp', '.cc', '.cxx', '.h', '.hpp',
    '.java', '.py', '.js', '.html', '.css',
    '.rb', '.php', '.swift', '.go', '.rs',
    '.m', '.mm', '.cs', '.lua', '.pl', '.sh',
    '.bat', '.sql', '.xml', '.json'
]

# Function to copy source code files to the destination directory
def copy_source_code_files(src_dir, dst_dir):
    for root, dirs, files in os.walk(src_dir):
        for file in files:
            if any(file.lower().endswith(ext) for ext in code_file_extensions):
                src_file_path = os.path.join(root, file)
                dst_file_path = os.path.join(dst_dir, file)
                
                # In case of duplicate filenames, append a number to the filename
                counter = 1
                file_name, file_extension = os.path.splitext(dst_file_path)
                while os.path.exists(dst_file_path):
                    dst_file_path = f"{file_name}({counter}){file_extension}"
                    counter += 1
                
                # Copy the file
                shutil.copy2(src_file_path, dst_file_path)
                print(f"Copied: {src_file_path} to {dst_file_path}")

# Call the function to start copying the files
copy_source_code_files(source_dir, destination_dir)
